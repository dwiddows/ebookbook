% The end to end process: second chapter.

\chapter{End to End: From Source to e-reader}

We'll start with the end-to-end process for making a book you can read
on your e-reader device. Checking that you can do this, change the title,
add or remove chapters, and see the changes you've made reflected on your 
e-reader, will hopefully be the best encouragement to work through more
of this book, focusing on the topics that are most useful for your own book.

\begin{figure}
\includegraphics[width=\linewidth]{images/pipeline.png}
\caption{Steps in the pipeline for shipping this ebook}
\label{fig:pipeline}
\end{figure}

The basic outline of the process is shown in Figure \ref{fig:pipeline}.
The rest of this chapter serves to describe the steps in more detail.

The descriptions of commands here will be relatively high-level ---
we'll say things ``install git and run git clone'', rather than giving
details on how to do this on various operating systems. This is for
three reasons. The first is that it's easier to write instructions
this way. The second is that very specific instructions of which web
addresses to visit and which buttons to click on can go stale very
quickly. The third is that this book does assume that the reader has
some experience with and / or tolerance for figuring out a certain
amount of installation and troubleshooting on computers. If not, there are
more constrained off-the-shelf tool that will be easier to get started with
than \latex.

%%
\section{Access and Build the \latex Source}

First of all, you'll want to get a copy of the source code for this
book. (We won't split hairs about whether \latex sources count as
`code'. It gives instructions to machines, it's easy to make mistakes
that show up as error messages, and it's reviewed and stored in source
control --- so it's like code in these practical senses.)

If you already have \texttt{git} installed, this will be something
like running \texttt{git clone
  https://github.com/dwiddows/ebookbook.git} at a command prompt, or
downloading the code using some visual client software. 

List the contents of this directory and check that you can see the
files \texttt{ebookbook.tex} and \texttt{build.sh}. The first of these
is the main \tex document that lays out how to combine the other files
into an ebook.  The second is a build script --- on platforms with
bash or a compatible shell installed, you should be able to run just
\texttt{./build.sh} and get most of the book built using one
command. Or at least, to begin with, you should get error messages
telling you if anything is missing and needs to be installed. If you're not
running a compatible shell, the \texttt{build.sh} will at least give a list
of commands you'll need to run some other way.

So the next step is to run \texttt{./build.sh} and ideally it should
typeset a copy of this book.

If this doesn't work, you may need to find and install some
\texttt{pdflatex} and most importantly \texttt{htlatex} programs that
work on your machine.

%%
\section{From HTML to ePub ... or Mobi}

The most important output from the previous step is a file called
\texttt{ebookbook.html}.  This is formatted for display as a webpage
in a browser. This is different from the more common use of \tex to
make documents such as academic papers, which are nowadays normally
created as PDF files. An HTML file is a collection of content (for
example, words and images to display), and typesetting suggestions
(for example, make this text a heading, and make this image 40\% of
the screen width). This is different from a PDF file, which has
precise instructions about how big to make each character and which
page to put it on. So it makes sense that HTML is more like an eBook:
instead of saying what text will appear on which page, it gives
directives about what text should be bigger and smaller, and this
combines with the user's device settings to decide which page it
should appear on.

So the \texttt{ebookbook.html} file (rather than the corresponding
\texttt{pdf} file or any other page-layout format) will be used to
create your eBook format. 

You can turn your HTML file form a webpage into an eBook by installing
and using a converter such as Amazon's {\em Kindle Previewer} tool.
There are a range of such converters and previewers, targetting a
variety of formats, and this is another place where the complexity of
electronic publication is obvious. Like saving an image as a
\texttt{.jpg}, \texttt{.gif} or \texttt{.png}, you'll need to select a
format to convert to, and options include:

\begin{itemize}
  \item \texttt{epub} is a cross-platform format that it supposed to
    be used for any electornic book.
  \item \texttt{mobi} is an old Amazon Kindle format --- and it
    happens to be the one you can use for e-mailing files to your Kindle.
\end{itemize}

%%
\section{Previewing Your Book on an e-Reader Device}

TODO



